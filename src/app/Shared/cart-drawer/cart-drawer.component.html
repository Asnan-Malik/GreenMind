<p-drawer [baseZIndex]="1100" [(visible)]="visible" closable="false" position="right" [style]="{width: '450px'}">
  <ng-template pTemplate="header">
    <div class="flex justify-between items-center w-full">
      <h3 class="text-xl font-semibold">Your Cart ({{cartItems.length}})</h3>
      <button
        class="text-gray-500 hover:text-gray-700 rounded-full w-8 h-8 flex items-center justify-center"
        (click)="onClose()">
        ✕
      </button>
    </div>
  </ng-template>

  <div class="h-full flex flex-col">
    <!-- Empty Cart State -->
    <div *ngIf="cartItems.length === 0" class="flex flex-col items-center justify-center h-full">
      <i class="fas fa-shopping-cart text-4xl text-gray-300 mb-4"></i>
      <p class="text-gray-500">Your cart is empty</p>
    </div>

    <!-- Cart Items -->
    <div *ngIf="cartItems.length > 0" class="flex-1 overflow-y-auto">
      <div *ngFor="let item of cartItems" class="flex gap-4 p-4 border-b">
        <img [src]="item.img" [alt]="item.name" class="w-20 h-20 object-cover rounded-lg">

        <div class="flex-1">
          <h4 class="font-medium">{{item.name}}</h4>
          <p class="text-green-600 font-semibold">${{item.selling_price | number:'1.2-2'}}</p>

          <div class="flex items-center mt-2">
            <button (click)="updateQuantity(item.id, item.quantity - 1)"
                    [disabled]="item.quantity <= 1"
                    class="w-8 h-8 flex items-center justify-center border rounded hover:bg-gray-100">
              −
            </button>
            <span class="mx-3 w-8 text-center">{{item.quantity}}</span>
            <button (click)="updateQuantity(item.id, item.quantity + 1)"
                    class="w-8 h-8 flex items-center justify-center border rounded hover:bg-gray-100">
              +
            </button>
          </div>
        </div>

        <div class="flex flex-col items-end">
          <button (click)="removeItem(item.id)" class="text-gray-400 hover:text-red-500">
            ✕
          </button>
          <p class="mt-4 font-semibold">
            ${{(item.selling_price * item.quantity) | number:'1.2-2'}}
          </p>
        </div>
      </div>
    </div>

    <!-- Order Summary -->
    <div *ngIf="cartItems.length > 0" class="border-t p-4">
      <div class="flex justify-between mb-2">
        <span>Subtotal</span>
        <span>${{subtotal | number:'1.2-2'}}</span>
      </div>
      <div class="flex justify-between mb-2">
        <span>Shipping</span>
        <span>${{shipping | number:'1.2-2'}}</span>
      </div>
      <div class="flex justify-between font-bold text-lg mt-4 pt-4 border-t">
        <span>Total</span>
        <span>${{total | number:'1.2-2'}}</span>
      </div>

      <p class="text-xs text-gray-500 mt-2">
        * Free shipping on orders over $30
      </p>

      <button (click)="proceedToCheckout()" class="w-full bg-green-600 hover:bg-green-700 text-white py-3 rounded-lg font-medium mt-4">
        Proceed to Checkout
      </button>
    </div>
  </div>
</p-drawer>
